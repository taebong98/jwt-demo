# ν”„λ΅μ νΈ κ°μ”
Java κΈ°λ° λ°±μ—”λ“ REST API κµ¬μ¶• κ³Όμ 

# κ°μΈμ μΈ λ„μ „ κ³Όμ 

# Swagger μ£Όμ† λ° μ”κµ¬μ‚¬ν•­ κµ¬ν„ μ—¬λ¶€
## (1) νμ›κ°€μ… - μ‚¬μ©μκ°€ μ‚Όμ©μ‚Όμ— κ°€μ…ν•΄μ•Ό ν•©λ‹λ‹¤.
- [x] μ—”λ“ν¬μΈνΈ: POST `/szs/signup`
- [x] ν•„μ νλΌλ―Έν„°μ— λ€ν• μ ν¨μ„± κ²€μ¦ λ° λ°μ΄ν„°λ² μ΄μ¤ μ μ•½μ΅°κ±΄ μ„¤μ •
  - μ •κ·ν‘ν„μ‹μ„ ν†µν•΄ μ£Όλ―Όλ“±λ΅λ²νΈ ν•μ‹ κ²€μ¦
  - userId, password, name, regNo μ»¬λΌμ— λ€ν•΄ λ°μ΄ν„°λ² μ΄μ¤ μ μ•½μ΅°κ±΄ μ„¤μ •
- [x] μ •ν•΄μ§„ μ μ €λ§ νμ›κ°€μ…μ΄ κ°€λ¥ν•λ‹¤.
- [x] ν¨μ¤μ›λ“μ™€ μ£Όλ―Όλ“±λ΅λ²νΈλ” μ•”νΈν™” λ μƒνƒλ΅ μ €μ¥ν•λ‹¤.

### κµ¬ν„ λ°©λ²•
#### 1-1. μ •ν•΄μ§„ μ μ €λ§ νμ›κ°€μ…μ΄ κ°€λ¥ν•΄μ•Ό ν•λ‹¤.
- Map μλ£κµ¬μ΅°λ¥Ό ν†µν•΄ μ •ν•΄μ§„ μ‚¬μ©μ λ©λ΅μ„ κ΄€λ¦¬(`com.taebong.szs.domain.vo.AllowedUsers`)
  - `AllowedUsers` ν΄λμ¤λ¥Ό BeanμΌλ΅ λ“±λ΅ν•λ’¤ UserServiceμ—μ„ DI λ°›μ•„ μ‚¬μ©μ λ©λ΅μ„ μ΅°ν 
  - κΈ°μ΅΄ Listλ¥Ό μ‚¬μ©ν•λ” μ½”λ“λ¥Ό Map μλ£ κµ¬μ΅°λ¥Ό μ‚¬μ©ν•λ„λ΅ λ³€κ²½ 
    - (commit: `a3af24475b0604e034b81682ff55b2b127e1602b`)
  - μ„λΉ„μ¤ κ·λ¨κ°€ μ»¤μ§€κ±°λ‚ μ”κµ¬μ‚¬ν•­μ΄ λ³€κ²½λλ©΄μ„, **νμ›κ°€μ… κ°€λ¥ μ μ €μ μκ°€ λμ–΄λ‚  κ°€λ¥μ„±μ„ κ³ λ ¤**
  - Map μλ£κµ¬μ΅°λ¥Ό μ‚¬μ©ν•λ©΄ μƒμμ‹κ°„(`O(1)`)μ— λ°μ΄ν„°λ¥Ό κ²€μƒ‰ν•  μ μκΈ° λ•λ¬Έμ—, νμ›κ°€μ… κ°€λ¥ μ μ €μ μκ°€ κΈ°ν•κΈ‰μμ μΌλ΅ λλ”λΌλ„ λ³‘λ©μ΄ λ°μƒν•  κ°€λ¥μ„±μ΄ μ λ‹¤κ³  νλ‹¨.

#### 1-2 λ―Όκ°μ •λ³΄λ” μ•”νΈν™” λ μƒνƒλ΅ μ €μ¥ν•΄μ•Ό ν•λ‹¤.
- Spring Securityμ—μ„ μ κ³µν•λ” μ•”νΈν™” κΈ°λ¥μ„ μ‚¬μ©
  - `BCryptPasswordEncoder.encode()` λ©”μ„λ“λ¥Ό ν™μ©ν•μ—¬ λΉ„λ°€λ²νΈμ™€ μ£Όλ―Όλ“±λ΅λ²νΈ μ•”νΈν™” μ§„ν–‰
    - λ³„λ„μ μ„¤μ •μ΄λ‚ κµ¬ν„ μ—†μ΄ μ•μ „ν• μ•”νΈν™” κΈ°λ¥ μ‚¬μ© κ°€λ¥
    - μ†”ν…κΈ°μ μ„ μ‚¬μ©ν•μ—¬ λΈλ£¨νΈν¬μ¤ κ³µκ²© λ° λ μΈλ³΄μ° ν…μ΄λΈ” κ³µκ²©μ— λ€μ‘ κ°€λ¥

### κ²€μ¦ κ²°κ³Ό
**λ‹¨μ„ν…μ¤νΈ, API νΈμ¶μ„ ν†µν•΄ κ²€μ¦**
- [x] `userId`, `password`, `name`, `regNo` λ°μ΄ν„° μ—†μ΄ νμ›κ°€μ… λ¶κ°€λ¥
- [x] `password`μ™€ `regNo`λ” μ•”νΈν™”ν•μ—¬ λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥
- [x] μ •ν•΄μ§„ μ‚¬μ©μλ§ νμ›κ°€μ… κ°€λ¥
  - [x] μ΄λ¦„κ³Ό μ£Όλ―Όλ“±λ΅λ²νΈκ°€ μΌμΉν•λ” κ²½μ° νμ› κ°€μ… κ°€λ¥
  - [x] μ΄λ¦„κ³Ό μ£Όλ―Όλ“±λ΅λ²νΈκ°€ μΌμΉν•μ§€ μ•μΌλ©΄ `ForbiddenException` λ°μƒ
  - [x] νμ›κ°€μ… μ”μ²­μ„ λ³΄λ‚΄λ” μ‚¬μ©μκ°€ μ •ν•΄μ§„ μ‚¬μ©μ λ©λ΅μ— μ΅΄μ¬ν•μ§€ μ•μΌλ©΄ `ForbiddenException` λ°μƒ

## (2) κ°€μ…ν• νμ›μ„ λ΅κ·ΈμΈ ν•λ” APIλ¥Ό μ‘μ„±ν•΄μ£Όμ„Έμ”.
- [x] μ—”λ“ν¬μΈνΈ: POST `/szs/login`
- [x] bodyλ΅ μ•„μ΄λ””μ™€ λΉ„λ°€λ²νΈλ¥Ό λ°›λ”λ‹¤.
- JWT + Spring Security
  - [x] λ°μ΄ν„°λ² μ΄μ¤μ— μ‚¬μ©μ μ•„μ΄λ””κ°€ μ—†λ‹¤λ©΄ μ»¤μ¤ν…€μμ™Έ λ°μƒ
  - [x] λ΅κ·ΈμΈ λΉ„λ°€λ²νΈμ™€ λ°μ΄ν„°λ² μ΄μ¤μ λΉ„λ°€λ²νΈκ°€ λ‹¤λ¥΄λ‹¤λ©΄ μ»¤μ¤ν…€μμ™Έ λ°μƒ
  - [x] λ΅κ·ΈμΈ νλΌλ―Έν„°μ™€ μ €μ¥ν•κ³  μλ” μ‚¬μ©μ μ •λ³΄κ°€ κ°™λ‹¤λ©΄ ν† ν° λ°κΈ‰

### κµ¬ν„λ°©λ²•
#### 2-1. μ‚¬μ©μ μ •λ³΄λ¥Ό λ°μ΄ν„°λ² μ΄μ¤μ—μ„ μ΅°νν•λ‹¤.
- ν΄λΌμ΄μ–Έλ“λ΅ λ¶€ν„° λ°›μ€ 'userId'λ¥Ό μ΄μ©ν•μ—¬ λ°μ΄ν„°λ² μ΄μ¤μ—μ„ μ‚¬μ©μλ¥Ό κ²€μƒ‰ν•λ‹¤.
  - SpringDataJpaμ findByUserId μ‚¬μ©
  - ν•΄λ‹Ή μ‚¬μ©μκ°€ μ—†λ” κ²½μ° NullPointerExceptionμ„ λ€λΉ„ν•μ—¬ Optional μ‚¬μ©
  
#### 2-2. λ΅κ·ΈμΈ μ‹ μ…λ ¥ν• ν¨μ¤μ›λ“μ™€ λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λμ–΄ μλ” ν¨μ¤μ›λ“λ¥Ό κ²€μ¦ν•λ‹¤.
- μ•”νΈν™” λμ–΄ μ €μ¥λΌ μλ” ν¨μ¤μ›λ“μ™€ ν‰λ¬ΈμΌλ΅ μ…λ ¥λ°›μ€ ν¨μ¤μ›λ“ μΌμΉμ—¬λ¶€λ¥Ό κ²€μ¦
  - PasswordEncoderμ match() λ©”μ„λ“ μ‚¬μ©
- λ§μ•½ λΉ„λ°€λ²νΈκ°€ μΌμΉν•μ§€ μ•λ‹¤λ©΄ μ»¤μ¤ν…€ μμ™ΈμΈ LoginExceptionμ„ λ°μƒμ‹ν‚¨λ‹¤.

#### 2-3. μ‚¬μ©μμ—κ² ν† ν°μ„ λ°ν–‰ν•΄μ¤€λ‹¤.
- idμ™€ passwordκ°€ μΌμΉν•λ‹¤λ©΄ JWT ν† ν° λ°ν–‰
- JWT λ°κΈ‰μ„ λ‹΄λ‹Ήν•λ” λ³„λ„μ ν΄λμ¤(`JwtTokenProvider`)λ¥Ό μƒμ„±ν•λ’¤ DI λ°›μ•„ μ‚¬μ©
  - Key κ°μ²΄ λ°κΈ‰, Claims, expire λ“±μ κ΄€μ‹¬μ‚¬λ” UserServiceμ κ΄€μ‹¬μ‚¬μ™€ λ³„λ„λ΅ κ΄€λ¦¬λμ–΄μ•Ό ν•λ‹¤κ³  νλ‹¨
  - λν• μ‚¬μ©μ μΈμ¦, κ¶ν•μ •λ³΄ μ΅°ν λ“± λ―Έλμ— μƒκ²¨λ‚  κ°€λ¥μ„±μ΄ μλ” μ”κµ¬μ‚¬ν•­μ„ κ΄€λ¦¬ν•κΈ°λ„ μ©μ΄ν•  κ²ƒμ΄λΌκ³  μƒκ°ν•¨ 
- ν‰λ¬ΈμΌλ΅ μ…λ ¥λ secretKeyλ¥Ό Base64λ΅ μΈμ½”λ”©ν•μ—¬ Keyκ°μ²΄ μƒμ„±
  - ymlμ— μ €μ¥λ secretKey λ…Έμ¶μ„ λ°©μ§€ν•κΈ° μ„ν•΄ Jsypt λ“± μ•”νΈν™” λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ© ν•„μ”(μ΄ λ¶€λ¶„μ€ μƒλµν–μµλ‹λ‹¤ πƒ)

### κ²€μ¦ κ²°κ³Ό
**λ‹¨μ„ν…μ¤νΈ, API νΈμ¶μ„ ν†µν•΄ κ²€μ¦**
- [x] μ”μ²­ νλΌλ©”ν„°λ΅ λ°›μ€ userIdλ΅ μ‚¬μ©μ μ •λ³΄λ¥Ό μ΅°νν•λ‹¤.
- [x] μ”μ²­ νλΌλ©”ν„°λ΅ λ°›μ€ passwordμ™€ λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λμ–΄ μλ” passwordκ°€ μΌμΉν•λ©΄ JWT ν† ν°μ„ λ°ν–‰ν•λ‹¤.

## (3) κ°€μ…ν• νμ› μ •λ³΄λ¥Ό κ°€μ Έμ¤λ” APIλ¥Ό μ‘μ„±ν•΄μ£Όμ„Έμ”.
- [x] μ—”λ“ν¬μΈνΈ: GET `/szs/me`
- [x] header ν•μ‹: "Authorization: Bearer {JWT Token}"
- [x] μΈμ¦ ν† ν°μ„ μ΄μ©ν•μ—¬ μκΈ° μ •λ³΄λ§ λ³Ό μ μμ–΄μ•Ό ν•λ‹¤.
  - [x] μΈμ¦ν† ν°μ€ ν—¤λ”λ΅ μ „λ‹¬ν•λ‹¤. 
  - [x] μΈμ¦ ν† ν° Claimsμ—μ„ μκΈ° μ •λ³΄λ¥Ό μ΅°νν• λ’¤ ν΄λΌμ΄μ–ΈνΈλ΅ λ¦¬ν„΄
  - [x] ν† ν° νμ‹±ν•λ©΄μ„ μ μ ν• μμ™Έμ²λ¦¬ ν•„μ”
  - [x] μ•”νΈν™” λ°©μ‹ λ³€κ²½(λ³µνΈν™” κ°€λ¥ν•λ„λ΅)

### κµ¬ν„λ°©λ²•
#### 3-1. λ³µνΈν™” μ•”νΈν™” μ•κ³ λ¦¬μ¦ λ³€κ²½
  - JWT ν† ν°μΌλ΅λ¶€ν„° μ‚¬μ©μ μ •λ³΄λ¥Ό μ΅°νν•κΈ° μ„ν•΄ μ•”νΈν™” λμ–΄μλ” μ •λ³΄λ¥Ό λ³µνΈν™” ν•  ν•„μ”κ°€ μμ—μ
  - μ΄λ¥Ό μ„ν•΄ κΈ°μ΅΄μ— μ‚¬μ©μ¤‘μ΄λ `PasswordEncoder`μ—μ„ `Encryptors`λ΅ λ³€κ²½

#### 3-2. μ‚¬μ©μ λ°μ΄ν„° μ΅°ν λ°©λ²•
  - JWTμ— λ¨λ“  μ •λ³΄λ¥Ό λ„£μ„κ²ƒμΈμ§€, userIdλ§ κ΄€λ¦¬ν•κ³  μ”μ²­λ§λ‹¤ λ°μ΄ν„°λ² μ΄μ¤μ—μ„ μ •λ³΄λ¥Ό μ΅°νν•΄μ¬ κ²ƒμΈμ§€μ— λ€ν•΄ κ³ λ―Ό
  - **JWTμ— λ¨λ“  μ •λ³΄λ¥Ό λ„£λ” κ²½μ° λ‹¨μ **
    - λ„¤νΈμ›ν¬ μ‚¬μ©λ‰ μ¦κ°€
    - JWTμ— λ―Όκ°μ •λ³΄λ¥Ό μ €μ¥ν•κ³  μκΈ° λ•λ¬Έμ— λ³΄μ• μ΄μ λ°μƒ κ°€λ¥
  - **userIdλ¥Ό ν†µν•΄ λ°μ΄ν„°λ² μ΄μ¤μ—μ„ μ‚¬μ©μ μ •λ³΄λ¥Ό μ΅°νν•λ” κ²½μ° λ‹¨μ **
    - λ°μ΄ν„°λ² μ΄μ¤μ™€ ν†µμ‹  κ³Όμ •μ—μ„ λ°μƒν•λ” λΉ„μ©
  - **κ²°κ³Ό**
    - "μΈμ¦ ν† ν° μ΄μ©ν•μ—¬"λΌλ” μ”κµ¬μ‚¬ν•­μ— λ”°λΌ μ „μμ λ°©μ‹ μ„ νƒ
    - λ―Όκ°μ •λ³΄λ¥Ό μ•”νΈν™”μ‹ν‚¨ μƒνƒλ΅ JWTμ— μ €μ¥
    - "userId, name, password, regNo" λ§ μ €μ¥ν•κΈ° λ•λ¬Έμ— λ„¤νΈμ›ν¬ μ „μ†΅λ‰μ— ν° μν–¥μ΄ μ—†λ‹¤κ³  νλ‹¨

#### 3-3. μ•”νΈν™” κ΄€μ‹¬μ‚¬ λ¶„λ¦¬
- μ•”νΈν™”, λ³µνΈν™”, λΉ„κµ λ΅μ§μ„ λ‹΄λ‹Ήν•λ” `CryptUtils` ν΄λμ¤ μƒμ„±
- UserServicdμ—μ„λ§ CryptUtilsμ„ μμ΅΄ν•κΈ° λ•λ¬Έμ— ν„μ¬μ™€ κ°™μ΄ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ΄ λ³€κ²½λμ–΄λ„ μ μ§€λ³΄μ, λ³€κ²½, ν™•μ¥μ— μ©μ΄

### κ²€μ¦κ²°κ³Ό
**λ‹¨μ„ν…μ¤νΈ, API νΈμ¶μ„ ν†µν•΄ κ²€μ¦**
- [x] Headerμ— JWT ν† ν°μ„ λ³΄λ‚΄λ©΄ ν•΄λ‹Ή ν† ν°μ„ νμ‹±ν•μ—¬ userId, name, password, regNoλ¥Ό ν΄λΌμ΄μ–ΈνΈλ΅ λ¦¬ν„΄